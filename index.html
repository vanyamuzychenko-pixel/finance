<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Мой первый портфель — адаптивная версия</title>
  <meta name="description" content="Учебный симулятор: реальные котировки MOEX ТОП-10, портфель, теория с видео и тест (20). Адаптивно под ПК и телефоны.">
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React из CDN + Babel для JSX без сборки -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3"></script>

  <style>
    html{scroll-behavior:smooth}
    .video-box{position:relative;width:100%;padding-top:56.25%}
    .video-box>iframe{position:absolute;inset:0;width:100%;height:100%;border:0}
    @media (max-width: 767px){
      .mobile-tabbar{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #e5e7eb;z-index:40}
      body{padding-bottom:64px}
    }
  </style>

</head>
<body class="bg-gray-50 text-gray-900">
  <div id="root"></div>

  <script type="text/babel">
    /* ===================== Конфиг ===================== */
    const TICKERS = [
      { secid:"SBER", name:"Сбербанк",      bcs:"https://bcs-express.ru/kotirovki-i-grafiki/sber" },
      { secid:"ROSN", name:"Роснефть",      bcs:"https://bcs-express.ru/kotirovki-i-grafiki/rosn" },
      { secid:"LKOH", name:"Лукойл",        bcs:"https://bcs-express.ru/kotirovki-i-grafiki/lkoh" },
      { secid:"NVTK", name:"Новатэк",       bcs:"https://bcs-express.ru/kotirovki-i-grafiki/nvtk" },
      { secid:"GAZP", name:"Газпром",       bcs:"https://bcs-express.ru/kotirovki-i-grafiki/gazp" },
      { secid:"PLZL", name:"Полюс",         bcs:"https://bcs-express.ru/kotirovki-i-grafiki/plzl" },
      { secid:"SIBN", name:"Газпром нефть", bcs:"https://bcs-express.ru/kotirovki-i-grafiki/sibn" },
      { secid:"GMKN", name:"Норникель",     bcs:"https://bcs-express.ru/kotirovki-i-grafiki/gmkn" },
      { secid:"YDEX", name:"Яндекс",        bcs:"https://bcs-express.ru/kotirovki-i-grafiki/ydex" },
      { secid:"TATN", name:"Татнефть",      bcs:"https://bcs-express.ru/kotirovki-i-grafiki/tatn" },
    ];

    // 20 вопросов
    const QUIZ = [
      { q:"Что такое ценная бумага по ГК РФ?", a:["Документ строгой отчётности","Именной финансовый инструмент","Документ, удостоверяющий имущественные права, реализация которых возможна только при его предъявлении","Договор между инвестором и эмитентом"], i:2, why:"Ключевой признак — реализация прав при предъявлении бумаги." },
      { q:"Акция — это…", a:["Долговая расписка эмитента","Доля участия в капитале компании","Производный инструмент","Купон по облигации"], i:1, why:"Акция подтверждает право собственности на долю компании." },
      { q:"Облигация — это…", a:["Доля участия в капитале","Долговой инструмент с возвратом номинала","Паи индексного фонда","Фьючерсный контракт"], i:1, why:"Облигация — займ эмитенту с выплатой дохода и возвратом номинала." },
      { q:"Что показывает фондовый индекс (например, IMOEX)?", a:["Среднюю дивидендную доходность","Изменение совокупной стоимости набора акций","Ставку ЦБ РФ","Объём торгов на бирже"], i:1, why:"Индекс отражает динамику корзины акций." },
      { q:"Котировка ‘SBER 312,50 ₽ +0,8%’ означает:", a:["Цена выросла на 0,8% к началу года","Цена выросла на 0,8% к предыдущему закрытию","Цена выше на 0,8% относительно номинала","Рост на 0,8% за час"], i:1, why:"Изменение указывается к предыдущей цене закрытия." },
      { q:"Диверсификация — это…", a:["Покупка одной самой сильной акции","Распределение вложений для снижения риска","Торговля внутри дня","Страхование портфеля деривативами"], i:1, why:"Смысл — распределение между активами и отраслями." },
      { q:"Что такое купон?", a:["Выплата дохода по облигации","Премия по опциону","Ежеквартальный дивиденд","Комиссия брокера"], i:0, why:"Купон — процентный доход по облигации." },
      { q:"ETF — это…", a:["Закрытый ПИФ","Фонд, торгуемый на бирже, следящий за индексом/стратегией","Фьючерс на индекс","Бумага, дающая право на льготный НДФЛ"], i:1, why:"ETF — биржевой фонд с прозрачной стратегией." },
      { q:"Ликвидность актива — это…", a:["Его доходность за год","Способность быстро купить/продать по близкой к рынку цене","Объём дивидендов","Кредитный рейтинг эмитента"], i:1, why:"Ликвидность = быстрота сделки без сильного отклонения цены." },
      { q:"Риск-премия — это…", a:["Премия брокеру","Надбавка доходности за принятие большего риска","Вознаграждение маркет-мейкеру","Гарантированный доход по облигации"], i:1, why:"Инвестор ожидает бОльшую доходность за риск." },
      { q:"Ребалансировка портфеля — это…", a:["Продажа всех бумаг","Доведение долей активов до целевых","Смена брокера","Отказ от дивидендов"], i:1, why:"Периодическое выравнивание долей к стратегиям." },
      { q:"Куда отнести фьючерсы и опционы?", a:["К основным ценным бумагам","К производным финансовым инструментам (деривативам)","К банковским продуктам","К криптоактивам"], i:1, why:"Это деривативы — договоры на будущую поставку/расчёт." },
      { q:"Доходность по облигации при покупке по 98% от номинала и погашении по 100% без купонов:", a:["≈+2%","0%","−2%","Зависит от инфляции"], i:0, why:"Прирост к номиналу — скидка 2% становится доходом." },
      { q:"Что означает ‘дивидендная отсечка’?", a:["Дата выплаты денег","Дата, после которой покупатель не получает ближайший дивиденд","Дата собрания акционеров","Дата первой продажи акции"], i:1, why:"Эк-дата — кто купил после, ближайший дивиденд не получает." },
      { q:"Маржин-колл — это…", a:["Сигнал о недостаточности обеспечения при торговле с плечом","Ограничение на акции ‘голубых фишек’","Комиссия биржи","Просьба закрыть счёт"], i:0, why:"Брокер требует довнести обеспечение или закрыть позиции." },
      { q:"Если корреляция двух активов низкая/отрицательная, то…", a:["Риск портфеля выше","Риск портфеля ниже при той же доходности","Разницы нет","Доходность падает до нуля"], i:1, why:"Диверсификационный эффект снижает риск." },
      { q:"Что такое ‘спрэд’?", a:["Разница между лучшими ценами покупки и продажи","Годовая доходность","Комиссия депозитария","Штраф за досрочную продажу"], i:0, why:"Bid-Ask spread — показатель ликвидности." },
      { q:"Лучшее описание ‘индекса волатильности’:", a:["Средняя дивидендная ставка","Оценка ожидаемой изменчивости рынка","Индекс облигаций","Курс валют"], i:1, why:"Индикатор ‘нервности’ рынка." },
      { q:"Что означает ‘T+2’ на бирже?", a:["Сделка расчётами через два рабочих дня","Торговля во второй половине дня","Комиссия 2%","Плечо 2"], i:0, why:"Стандарт расчётов по акциям в РФ — два рабочих дня." },
      { q:"Что важно для долгосрочного инвестора?", a:["Часовой график","Краткосрочный шум","Состав портфеля, дисциплина и издержки","Только прогноз аналитика"], i:2, why:"Ключ — стратегия, диверсификация, контроль комиссий." },
    ];

    const fmtCur = n => n.toLocaleString('ru-RU',{style:'currency',currency:'RUB',maximumFractionDigits:2});
    const fmtPct = x => (x>=0?'+':'') + (x*100).toFixed(2) + '%';

    /*  Приложение  */
    function App(){
      const [tab,setTab] = React.useState('market'); // market | sim | learn | quiz
      const [asOf, setAsOf] = React.useState('');
      const [err, setErr] = React.useState('');
      const [loading, setLoading] = React.useState(false);
      const [quotes, setQuotes] = React.useState(TICKERS.map(t=>({...t, last:null, chgPct:null})));

      // Симулятор
      const [running, setRunning] = React.useState(true);
      const [cash, setCash] = React.useState(100_000);
      const [pos, setPos] = React.useState({}); // {SBER:{qty,avg}}
      const [sim, setSim] = React.useState([]);  // [{secid,name,price,path:[]}]
      const equity = React.useMemo(()=> sim.reduce((s,a)=> s + ((pos[a.secid]?.qty||0) * a.price),0),[sim,pos]);
      const total = cash + equity;
      const ret = (total - 100_000)/100_000;

      // ======= Цены MOEX ISS
      async function loadPrices(){
        try{
          setLoading(true); setErr('');
          const list = TICKERS.map(t=>t.secid).join(',');
          const url = `https://iss.moex.com/iss/engines/stock/markets/shares/boards/TQBR/securities.json?iss.meta=off&iss.only=marketdata,securities&securities=${list}`;
          const r = await fetch(url,{cache:'no-store'}); if(!r.ok) throw new Error('HTTP '+r.status);
          const j = await r.json();
          const cols = j.marketdata.columns, data = j.marketdata.data;
          const iSEC=cols.indexOf('SECID'), iLAST=cols.indexOf('LAST'), iPCT=cols.indexOf('LASTCHANGEPRCNT'), iLTPR=cols.indexOf('LASTTOPREVPRICE');
          const map = new Map();
          for(const row of data){
            const sec = row[iSEC], last=row[iLAST];
            const pct = iPCT>=0? row[iPCT] : (iLTPR>=0&&row[iLTPR]!=null? (row[iLTPR]-1)*100:null);
            map.set(sec,{last,pct});
          }
          const q = TICKERS.map(t=>({...t,last:map.get(t.secid)?.last??null, chgPct:map.get(t.secid)?.pct??null}));
          setQuotes(q);
          setAsOf(new Date().toLocaleString('ru-RU'));

          // инициализация симулятора реальными ценами
          setSim(prev=>{
            if(prev.length) return prev;
            return q.map(t=>{
              const p=t.last??100;
              return {secid:t.secid,name:t.name,price:p,path:[{x:0,y:p}]};
            });
          });
        }catch(e){ console.error(e); setErr('Не удалось получить котировки с MOEX ISS. Попробуйте ещё раз.'); }
        finally{ setLoading(false); }
      }
      React.useEffect(()=>{ loadPrices(); },[]);

      // ======= Тики симулятора: ±0.2% вокруг текущей
      React.useEffect(()=>{
        if(!running || sim.length===0) return;
        const id=setInterval(()=>{
          setSim(prev => prev.map(a=>{
            const shock = (Math.random()*2 - 1) * 0.002; // ±0.2%
            const next = Math.max(0.01, a.price*(1+shock));
            const nextPath = [...a.path, {x:(a.path[a.path.length-1].x+1), y:next}].slice(-120);
            return {...a, price:+next.toFixed(2), path:nextPath};
          }));
        }, 1200);
        return ()=>clearInterval(id);
      },[running, sim.length]);

      // Торговля
      function trade(secid, side, qtyInput){
        const a = sim.find(x=>x.secid===secid); if(!a) return;
        const qty = Math.max(1, Math.floor(Number(qtyInput)||1));
        if(side==='buy'){
          const cost = qty*a.price; if(cost>cash) return;
          setCash(c=>c-cost);
          setPos(p=>{
            const cur=p[secid]||{qty:0,avg:a.price};
            const nqty=cur.qty+qty, navg=(cur.qty*cur.avg+qty*a.price)/nqty;
            return {...p,[secid]:{qty:nqty,avg:+navg.toFixed(2)}};
          });
        }else{
          setPos(p=>{
            const cur=p[secid]; if(!cur || cur.qty<qty) return p;
            setCash(c=>c+qty*a.price);
            const nqty=cur.qty-qty;
            if(nqty===0){ const{[secid]:_,...rest}=p; return rest; }
            return {...p,[secid]:{qty:nqty,avg:cur.avg}};
          });
        }
      }
      function resetSim(){ setCash(100_000); setPos({}); }

      // ======= Тест (20)
      const [answers,setAnswers]=React.useState(Array(QUIZ.length).fill(null));
      const [showResult,setShowResult]=React.useState(false);
      const correctCount = answers.reduce((s,a,i)=> s + (a===QUIZ[i].i?1:0),0);
      const progress = Math.round(answers.filter(v=>v!==null).length/QUIZ.length*100);

      function exportCSV(){
        const rows=[["Тикер","Компания","Кол-во","Средняя","Текущая","Нереализ. P&L"]];
        sim.forEach(a=>{
          const p=pos[a.secid]; if(p?.qty){
            const pnl=p.qty*(a.price-p.avg);
            rows.push([a.secid,a.name,p.qty,p.avg,a.price,pnl.toFixed(2)]);
          }
        });
        rows.push([]); rows.push(["Кэш",cash.toFixed(2)]);
        rows.push(["Инвестировано",equity.toFixed(2)]);
        rows.push(["Стоимость портфеля",total.toFixed(2)]);
        rows.push(["Доходность",(ret*100).toFixed(2)+"%"]);
        const csv = rows.map(r=> r.map(v=> `"${String(v).replaceAll('"','""')}"`).join(',')).join('\n');
        const blob=new Blob(["\ufeff"+csv],{type:"text/csv;charset=utf-8;"}); const url=URL.createObjectURL(blob);
        const a=document.createElement('a'); a.href=url; a.download='portfolio_export.csv'; a.click(); URL.revokeObjectURL(url);
      }
      function exportQuiz(){
        const lines=[];
        lines.push(`Тест: ${correctCount}/${QUIZ.length} (${Math.round(correctCount/QUIZ.length*100)}%)`);
        lines.push("");
        QUIZ.forEach((q,idx)=>{
          const u=answers[idx]; const ok = u===q.i;
          lines.push(`${idx+1}. ${q.q}`);
          lines.push(`   Ваш ответ: ${u!==null? q.a[u]:"—"}`);
          lines.push(`   Верно: ${q.a[q.i]}`);
          lines.push(`   Пояснение: ${q.why}`);
          lines.push(`   Результат: ${ok?"верно":"ошибка"}`);
          lines.push("");
        });
        const blob=new Blob([lines.join('\n')],{type:"text/plain;charset=utf-8;"}); const url=URL.createObjectURL(blob);
        const a=document.createElement('a'); a.href=url; a.download='quiz_result.txt'; a.click(); URL.revokeObjectURL(url);
      }

      return (
        <div className="min-h-screen">
          {/* Шапка */}
          <header className="sticky top-0 z-20 bg-white/90 backdrop-blur border-b">
            <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
              <div className="min-w-0">
                <div className="text-[10px] sm:text-xs text-gray-500 truncate">Дисциплина: Финансы, денежное обращение и кредит — Тема: Рынок ценных бумаг</div>
                <h1 className="text-base sm:text-xl font-bold truncate">Симулятор инвестора «Мой первый портфель»</h1>
              </div>
              {/* Десктоп-меню */}
              <nav className="hidden md:flex gap-2 text-sm">
                <TabLink id="market" tab={tab} setTab={setTab}>Котировки</TabLink>
                <TabLink id="sim"    tab={tab} setTab={setTab}>Портфель</TabLink>
                <TabLink id="learn"  tab={tab} setTab={setTab}>Обучение</TabLink>
                <TabLink id="quiz"   tab={tab} setTab={setTab}>Тест (20)</TabLink>
              </nav>
            </div>
          </header>

          {/* Мобильный таббар */}
          <nav className="mobile-tabbar md:hidden">
            <div className="max-w-6xl mx-auto px-2 py-2 grid grid-cols-4 gap-2 text-xs">
              <button onClick={()=>setTab('market')} className={`px-2 py-2 rounded-xl border ${tab==='market'?'bg-gray-100':''}`}>Кот.</button>
              <button onClick={()=>setTab('sim')}     className={`px-2 py-2 rounded-xl border ${tab==='sim'?'bg-gray-100':''}`}>Портфель</button>
              <button onClick={()=>setTab('learn')}   className={`px-2 py-2 rounded-xl border ${tab==='learn'?'bg-gray-100':''}`}>Обучение</button>
              <button onClick={()=>setTab('quiz')}    className={`px-2 py-2 rounded-xl border ${tab==='quiz'?'bg-gray-100':''}`}>Тест</button>
            </div>
          </nav>

          <main className="max-w-6xl mx-auto px-2 sm:px-4 py-4 sm:py-6 space-y-6">
            {/* Инфо-блок */}
            <div className="bg-amber-50 border border-amber-200 rounded-2xl p-3 text-[12px] sm:text-sm text-amber-800">
              Источник цен: <b>MOEX ISS</b>. Ссылки «Открыть» ведут на карточки <b>БКС Мир инвестиций</b>.
            </div>

            {/* КОТИРОВКИ */}
            {tab === 'market' && (
              <section className="bg-white border rounded-2xl p-3 sm:p-4 shadow-sm">
                <div className="flex flex-col sm:flex-row gap-2 sm:items-end sm:justify-between mb-3">
                  <div>
                    <h2 className="font-semibold text-base sm:text-lg">ТОП-10 компаний РФ · реальные котировки</h2>
                    <div className="text-xs text-gray-600">Нажмите «Обновить цены» для свежего среза</div>
                  </div>
                  <div className="flex gap-2 items-center">
                    <button onClick={loadPrices} className="px-3 py-1.5 rounded-xl border text-sm hover:bg-gray-100" disabled={loading}>
                      {loading? 'Обновляю…':'Обновить цены'}
                    </button>
                    <div className="text-xs text-gray-500">Обновлено: {asOf||'—'}</div>
                  </div>
                </div>
                {err && <div className="text-sm text-rose-600 mb-2">{err}</div>}
                <div className="overflow-x-auto -mx-2 sm:mx-0">
                  <table className="min-w-[640px] sm:min-w-full text-sm">
                    <thead>
                      <tr className="text-left text-gray-600">
                        <th className="py-2 px-2">№</th>
                        <th className="py-2 px-2">Компания</th>
                        <th className="py-2 px-2">Тикер</th>
                        <th className="py-2 px-2">Цена, ₽</th>
                        <th className="py-2 px-2">Изм., %</th>
                        <th className="py-2 px-2">БКС</th>
                      </tr>
                    </thead>
                    <tbody>
                      {quotes.map((q,i)=>(
                        <tr key={q.secid} className="border-t">
                          <td className="py-2 px-2 w-10">{i+1}</td>
                          <td className="py-2 px-2">{q.name}</td>
                          <td className="py-2 px-2 font-mono">{q.secid}</td>
                          <td className="py-2 px-2">{q.last!=null? q.last.toLocaleString('ru-RU',{minimumFractionDigits:2,maximumFractionDigits:2}) : '—'}</td>
                          <td className={`py-2 px-2 ${Number(q.chgPct)>=0?'text-emerald-600':'text-rose-600'}`}>{q.chgPct!=null? q.chgPct.toFixed(2):'—'}</td>
                          <td className="py-2 px-2"><a href={q.bcs} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">Открыть</a></td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </section>
            )}

            {/* ПОРТФЕЛЬ */}
            {tab === 'sim' && (
              <section className="grid lg:grid-cols-3 gap-4 sm:gap-6">
                <div className="lg:col-span-2 bg-white border rounded-2xl p-3 sm:p-4 shadow-sm">
                  <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-2">
                    <h2 className="font-semibold text-base sm:text-lg">Портфельный симулятор (эти 10 бумаг)</h2>
                    <div className="flex gap-2">
                      <button onClick={()=>setRunning(r=>!r)} className="px-3 py-1.5 rounded-xl border text-sm hover:bg-gray-100">
                        {running? 'Пауза рынка':'Старт рынка'}
                      </button>
                      <button onClick={resetSim} className="px-3 py-1.5 rounded-xl border text-sm hover:bg-gray-100">Сброс</button>
                    </div>
                  </div>
                  <div className="overflow-x-auto -mx-2 sm:mx-0">
                    <table className="min-w-[640px] sm:min-w-full text-sm">
                      <thead>
                        <tr className="text-left text-gray-600">
                          <th className="py-2 px-2">Тикер</th><th className="py-2 px-2">Компания</th><th className="py-2 px-2">Цена</th><th className="py-2 px-2">Кол-во</th><th className="py-2 px-2">Действия</th>
                        </tr>
                      </thead>
                      <tbody>
                        {sim.map(a => <Row key={a.secid} a={a} onTrade={trade}/>)}
                      </tbody>
                    </table>
                  </div>
                </div>

                <aside className="bg-white border rounded-2xl p-3 sm:p-4 shadow-sm space-y-3">
                  <div className="grid grid-cols-2 gap-2 text-sm">
                    <Stat label="Кэш" value={fmtCur(cash)} />
                    <Stat label="Инвестировано" value={fmtCur(equity)} />
                    <Stat label="Стоимость" value={fmtCur(total)} />
                    <Stat label="Доходность" value={ret} isReturn />
                  </div>
                  <Sparkline title="Стоимость портфеля" value={total} />
                  <Donut positions={Object.entries(pos).map(([secid,p])=>({
                    label: secid,
                    value: p.qty * (sim.find(a=>a.secid===secid)?.price || 0)
                  }))}/>
                  <button onClick={exportCSV} className="w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-100">Экспорт портфеля (CSV)</button>
                </aside>
              </section>
            )}

            {/* ОБУЧЕНИЕ */}
            {tab === 'learn' && (
              <section className="bg-white rounded-2xl shadow border p-3 sm:p-4 space-y-3">
                <h2 className="font-semibold text-base sm:text-lg">Обучающий блок</h2>

                
<details className="border rounded-xl p-3">
  <summary className="cursor-pointer font-medium">1. Понятие финансового рынка. Место рынка ценных бумаг</summary>
  <div className="mt-2 text-sm text-gray-800 space-y-3">
    <p><b>Финансовый рынок</b> — совокупность институтов и правил, через которые свободные деньги превращаются в инвестиции. Он включает денежный рынок (краткосрочные инструменты), рынок капитала (акции и облигации), валютный рынок, рынок производных инструментов, а также страховой и пенсионный сегменты. <b>Рынок ценных бумаг</b> — ядро рынка капитала, где осуществляются выпуск (первичный рынок) и обращение (вторичный рынок) акций, облигаций и иных инструментов.</p>

    <h4 className="font-semibold">Ключевая роль рынка ценных бумаг в экономике</h4>
    <ul className="list-disc pl-5 space-y-1.5">
      <li><b>Трансформация сбережений в инвестиции.</b> Направляет временно свободные средства домохозяйств и компаний к тем, кто способен эффективно их вложить — предприятим и государству.</li>
      <li><b>Ценообразование и распределение капитала.</b> Рыночные цены акций и доходности облигаций сигнализируют, куда капиталу идти: проекты с лучшими перспективами получают финансирование быстрее и дешевле.</li>
      <li><b>Управление рисками и сроками.</b> Разнообразие инструментов (акции/облигации/деривативы) позволяет участникам выбирать уровень риска, срок вложений и тип дохода (процент/дивиденд/курсовая разница).</li>
      <li><b>Ликвидность и возможность выхода.</b> Вторичный рынок даёт инвестору право быстро превратить бумаги в деньги, не останавливая финансирование эмитента.</li>
      <li><b>Корпоративное управление и дисциплина эмитентов.</b> Требования к раскрытию информации, листингу, сделкам с заинтересованностью повышают ответственность компаний перед инвесторами.</li>
      <li><b>Обслуживание государственного долга.</b> Через государственные облигации финансируются дефицит бюджета, инфраструктурные и социальные проекты.</li>
      <li><b>Канал денежно‑кредитной политики.</b> Доходности облигаций формируют «безрисковую» ставку экономики и влияют на стоимость заимствований для бизнеса и населения.</li>
      <li><b>Интеграция в мировую экономику.</b> Рынок бумаг соединяет внутренние и внешние источники капитала, обеспечивает приток/отток инвестиций и валютную выручку.</li>
    </ul>

    <h4 className="font-semibold">Кому и чем полезен рынок ценных бумаг</h4>
    <div className="grid sm:grid-cols-3 gap-3">
      <div className="border rounded-lg p-3">
        <div className="font-medium mb-1">Государству</div>
        <ul className="list-disc pl-5 space-y-1">
          <li>финансирование дефицита бюджета и проектов через облигации;</li>
          <li>формирование кривой безрисковых ставок;</li>
          <li>прозрачная оценка ожиданий рынка и инфляции.</li>
        </ul>
      </div>
      <div className="border rounded-lg p-3">
        <div className="font-medium mb-1">Бизнесу</div>
        <ul className="list-disc pl-5 space-y-1">
          <li>доступ к долгосрочному и сравнительно дешёвому капиталу (IPO/SPO/облигации);</li>
          <li>рыночная оценка стоимости компании, возможность сделок M&amp;A;</li>
          <li>диверсификация источников финансирования помимо банков.</li>
        </ul>
      </div>
      <div className="border rounded-lg p-3">
        <div className="font-medium mb-1">Домохозяйствам</div>
        <ul className="list-disc pl-5 space-y-1">
          <li>накопление и приумножение средств, защита от инфляции;</li>
          <li>участие в приватизации и распределении прибыли компаний;</li>
          <li>возможность гибких стратегий (сбережение, инвестиции, страхование рисков).</li>
        </ul>
      </div>
    </div>

    <h4 className="font-semibold">Связи с другими сегментами финансовой системы</h4>
    <ul className="list-disc pl-5 space-y-1.5">
      <li><b>Банковский сектор:</b> банки кредитуют кратко‑ и среднесрочно, а рынок бумаг обеспечивает долгосрочные вложения; вместе они формируют стоимость капитала.</li>
      <li><b>Валютный рынок:</b> через операции нерезидентов и валютные облигации связывает движение капитала и курс национальной валюты.</li>
      <li><b>Рынок производных инструментов:</b> даёт хеджирование процентных, валютных и ценовых рисков базовых бумаг.</li>
      <li><b>Страховой/пенсионный сектор:</b> крупные институциональные инвесторы — стабильный источник долгих денег для эмитентов.</li>
    </ul>

    <h4 className="font-semibold">Ключевые показатели, которые характеризуют место рынка ценных бумаг</h4>
    <ul className="list-disc pl-5 space-y-1.5">
      <li>рыночная капитализация акций и объём облигационного долга к ВВП;</li>
      <li>объём размещений на первичном рынке (IPO/SPO/облигации) и оборот вторичного рынка;</li>
      <li>структура инвесторов (доля институциональных инвесторов, доля нерезидентов, free float);</li>
      <li>ликвидность и глубина рынка, волатильность и динамика фондовых индексов.</li>
    </ul>

    <h4 className="font-semibold">Кратко: место рынка ценных бумаг в экономике</h4>
    <p>Рынок ценных бумаг — это «кровеносная система» инвестиционного процесса: он собирает сбережения, устанавливает «цену денег», распределяет капитал в пользу эффективных проектов и обеспечивает возможность выхода из инвестиций. Через него государство и бизнес финансируют развитие, а домохозяйства участвуют в создании национального богатства.</p>
  </div>
</details>


                <details className="border rounded-xl p-3">
                  <summary className="cursor-pointer font-medium">2. Основные виды ценных бумаг (ГК РФ)</summary>
                  <div className="mt-2 text-sm text-gray-800 space-y-2">
                    <p>Согласно законодательству РФ ценными бумагами являются документы, соответствующие установленным законом требованиям и удостоверяющие обязательные и иные права, осуществление или передача которых возможны только при предъявлении таких документов (документарные ценные бумаги).</p>
                    <p>Также ценными бумагами признаются обязательные и иные права, которые закреплены в решении о выпуске или ином акте лица, выпустившего такие ценные бумаги в соответствии с требованиями закона, и осуществление и передача которых возможны только с соблюдением правил учета этих прав (бездокументарные ценные бумаги).</p>
                    <h3 className="font-semibold">Виды ценных бумаг</h3>
                    <p>Ценные бумаги могут быть представлены как документарные или бездокументарные, ордерные, именные и на предъявителя.</p>
                    <p><b>Ценной бумагой на предъявителя</b> является документарная ценная бумага, по которой лицом, уполномоченным требовать исполнения обязательств по ней, признается ее владелец. При этом выпуск и размещение ценных бумаг на предъявителя допускается только в законодательно установленном порядке.</p>
                    <p><b>Ордерной</b> является документарная ценная бумага, по которой лицом, уполномоченным требовать исполнения обязательств по ней, признается ее владелец, если ценная бумага выдана на его имя или перешла к нему от первого владельца по непрерывному ряду индоссаментов.</p>
                    <p><b>Именной</b> также является документарная ценная бумага, по которой лицом, уполномоченным требовать исполнения обязательств по ней, признается одно из следующих лиц:</p>
                    <ul className="list-disc pl-5">
                      <li>владелец ценной бумаги, указанный в качестве правообладателя в учетных записях, которые ведутся обязанным лицом или действующим лицом по его поручению и имеющим соответствующую лицензию;</li>
                      <li>владелец ценной бумаги, если ценная бумага была выдана на его имя или перешла к нему от первого владельца в порядке непрерывного ряда уступок права требования (цессий) путем совершения на ней именных передаточных надписей или в иной форме в соответствии с правилами, установленными для уступки права требования (цессии).</li>
                    </ul>
                    <p>К бездокументарным ценным бумагам применяются правила, касающиеся именных документарных ценных бумаг, правообладатель которых определяется в соответствии с учетными записями.</p>
                    <p>К обращению на финансовом рынке России допущены следующие ценные бумаги: государственная облигация, акция, вексель, закладная, инвестиционный пай паевого инвестиционного фонда, коносамент, облигация, чек, ипотечные ценные бумаги и иные ценные бумаги, названные в таком качестве в законе или признанные таковыми в установленном законом порядке.</p>
                    <p>Характеристики ценных бумаг сведены в табл. 2.1, которая позволяет группировать их по таким признакам, как тип документа: именной, ордерный, на предъявителя; форма выпуска: документарная или бездокументарная; разряд ценной бумаги: долговая, долевая, платежная и пр.</p>
<h4 className="font-semibold mt-3 mb-2">Характеристика ценных бумаг</h4>
<div className="overflow-x-auto">
  <table className="min-w-full text-xs sm:text-sm border border-gray-300">
    <thead className="bg-gray-50">
      <tr>
        <th className="border px-2 py-1 align-bottom">Ценные бумаги</th>
        <th className="border px-2 py-1 align-bottom" colSpan="3">Тип ценной бумаги</th>
        <th className="border px-2 py-1 align-bottom" colSpan="2">Форма выпуска</th>
        <th className="border px-2 py-1 align-bottom" colSpan="6">Разряд ценной бумаги</th>
      </tr>
      <tr className="bg-gray-50">
        <th className="border px-2 py-1"></th>
        <th className="border px-2 py-1">именная</th>
        <th className="border px-2 py-1">ордерная</th>
        <th className="border px-2 py-1">на предъявителя</th>
        <th className="border px-2 py-1">бездокументарная</th>
        <th className="border px-2 py-1">документарная</th>
        <th className="border px-2 py-1">долговая</th>
        <th className="border px-2 py-1">долевая</th>
        <th className="border px-2 py-1">платёжная</th>
        <th className="border px-2 py-1">товарораспорядительная</th>
        <th className="border px-2 py-1">производная</th>
        <th className="border px-2 py-1">приватизационная</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td className="border px-2 py-1">Государственная облигация</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Облигация</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Депозитный и сберегательный сертификаты</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Банковская книжка на предъявителя</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Закладная</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Акция</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Вексель</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Чек</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Простое складское свидетельство</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Складское свидетельство двойное (ДСС)</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Часть ДСС — складское свидетельство</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Часть ДСС — залоговое свидетельство (варрант)</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Коносамент</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Приватизационные ценные бумаги</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td>
      </tr>
      <tr>
        <td className="border px-2 py-1">Опцион эмитента</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
      </tr>
      <tr className="bg-gray-50/60">
        <td className="border px-2 py-1">Российские депозитарные расписки</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td>
        <td className="border px-2 py-1">–</td><td className="border px-2 py-1">✓</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td><td className="border px-2 py-1">–</td>
      </tr>
    </tbody>
  </table>
</div>

<h4 className="font-semibold mt-5 mb-2">Классификация ценных бумаг</h4>
<div className="overflow-x-auto">
  <table className="min-w-full text-xs sm:text-sm border border-gray-300">
    <thead className="bg-gray-50">
      <tr>
        <th className="border px-2 py-1 text-left">Классификационный признак</th>
        <th className="border px-2 py-1 text-left">Характерные признаки ценных бумаг</th>
      </tr>
    </thead>
    <tbody>
      <tr><td className="border px-2 py-1">По эмитенту и статусу</td><td className="border px-2 py-1">Государственные; Корпоративные</td></tr>
      <tr className="bg-gray-50/60"><td className="border px-2 py-1">По виду ценной бумаги</td><td className="border px-2 py-1">Долговые обязательства (облигации и т. д.); Долевые ценные бумаги (акции)</td></tr>
      <tr><td className="border px-2 py-1">По способу выпуска</td><td className="border px-2 py-1">Эмиссионные; Неэмиссионные</td></tr>
      <tr className="bg-gray-50/60"><td className="border px-2 py-1">По форме выпуска</td><td className="border px-2 py-1">Документарные; Бездокументарные</td></tr>
      <tr><td className="border px-2 py-1">По субъекту прав</td><td className="border px-2 py-1">Именные; На предъявителя; Ордерные</td></tr>
      <tr className="bg-gray-50/60"><td className="border px-2 py-1">По виду начисляемого дохода</td><td className="border px-2 py-1">С фиксированным доходом; С переменным доходом</td></tr>
      <tr><td className="border px-2 py-1">По обеспечению</td><td className="border px-2 py-1">Обеспеченные; Необеспеченные; Гарантированные</td></tr>
      <tr className="bg-gray-50/60"><td className="border px-2 py-1">По валюте номинала</td><td className="border px-2 py-1">Валюта Российской Федерации; Иностранная валюта</td></tr>
      <tr><td className="border px-2 py-1">По сроку обращения</td><td className="border px-2 py-1">Краткосрочные — до 1 года; Среднесрочные — 1—5 лет; Долгосрочные — 5—30 лет; Бессрочные</td></tr>
      <tr className="bg-gray-50/60"><td className="border px-2 py-1">По типу инвестора</td><td className="border px-2 py-1">Физические лица; Юридические лица; Резиденты; Нерезиденты</td></tr>
      <tr><td className="border px-2 py-1">По виду заимствований</td><td className="border px-2 py-1">Внешний долг; Внутренний долг</td></tr>
    </tbody>
  </table>
</div>

                    
                    
                    

                    <h3 className="font-semibold">Производные финансовые инструменты рынка ценных бумаг</h3>
                    <p>Современный развитый фондовый рынок включает в себя наряду со спотовым рынком (сделки купли-продажи на котором сопровождаются поставкой ценных бумаг) также и рынок производных финансовых инструментов (деривативов). Это название они получили потому, что выполнение обязательств по этим инструментам предполагает осуществление операций с другими ценными бумагами, валютой и товарами, составляющими их базисный актив. Подобные инструменты рынка ценных бумаг предоставляют возможность страхования финансовых рисков.</p>
                    <p>На рынках производных финансовых инструментов риски, достигающие миллиардов долларов, постоянно перемещаются от тех, кто не может себе их позволить, к тем, кто надеется их избежать. Наиболее известными производными финансовыми инструментами являются срочные инструменты — форвардные контракты, фьючерсы и опционы.</p>
                    <p><b>Форвардный контракт</b> — договор между двумя контрагентами о поставке актива в будущем по согласованной цене; на практике для страхования чаще используют фьючерсные контракты.</p>
                    <p><b>Фьючерс</b> — стандартизированный биржевой контракт на поставку/расчет по фиксированной цене в будущем; клиринг ведёт расчетная палата.</p>
                    <p><b>Опцион</b> — контракт, предоставляющий право (но не обязанность) купить или продать актив по установленной цене в течение определенного времени. Используется как для спекуляций, так и для страхования.</p>
                    <p>Механизм страхования сделок через деривативы — <b>хеджирование</b>. На российском рынке ценными бумагами признаются <b>опционы эмитента</b> и <b>российские депозитарные расписки</b> (РДР); форварды/фьючерсы/биржевые опционы — производные инструменты, но не ЦБ.</p>
                  </div>
                </details>

                <details className="border rounded-xl p-3">
                  <summary className="cursor-pointer font-medium">3. Участники рынка ценных бумаг</summary>
                  <div className="mt-2 text-sm text-gray-800 space-y-3">
                    <div>
                      <h4 className="font-semibold">Ключевые группы участников</h4>
                      <ul className="list-disc pl-5">
                        <li><b>Инвесторы</b> — физические лица и институты, размещающие свободные средства.</li>
                        <li><b>Эмитенты</b> — государство/субъекты/муниципалитеты и компании, выпускающие ценные бумаги для привлечения финансирования.</li>
                        <li><b>Профессиональные участники</b> — лицензируемые юрлица, выполняющие специализированные функции на рынке.</li>
                        <li><b>Инфраструктура организованных торгов</b> — биржи (организаторы торгов), клиринг, депозитарная система, репозитарии.</li>
                        <li><b>Регуляторы и СРО</b> — Банк России (надзор, лицензирование), саморегулируемые организации.</li>
                    </ul>
                  </div>

                  <div>
                    <h4 className="font-semibold">Профессиональные участники</h4>
                    <ul className="list-disc pl-5 space-y-1.5">
                      <li><b>Брокер.</b> Исполняет поручения клиента на покупку/продажу ценных бумаг. Доход — комиссии/вознаграждение.</li>
                      <li><b>Дилер.</b> Покупает/продаёт от своего имени и за свой счёт; может котировать цены (маркет-мейкинг). Доход — спрэд/переоценка.</li>
                      <li><b>Форекс-дилер.</b> Сделки с валютой/деривативами вне биржи для физлиц; предоставляет плечо; повышенные требования к раскрытию рисков.</li>
                      <li><b>Доверительное управление (ДУ).</b> Управляющая компания ведёт портфели клиентов (деньги, ценные бумаги, производные) по договору ДУ.</li>
                      <li><b>Депозитарий.</b> Учёт прав на ценные бумаги, переход прав «поставка против платежа», корпоративные действия.</li>
                      <li><b>Регистратор (реестродержатель).</b> Ведение реестра владельцев эмиссионных ценных бумаг конкретного эмитента, выдача выписок.</li>
                      <li><b>Инвестиционный советник.</b> Даёт персональные инвестиционные рекомендации, состоит в реестре/СРО.</li>
                    </ul>
                    <p className="text-xs text-gray-600">
                      Отличие <b>депозитария</b> и <b>регистратора</b>:
                      регистратор учитывает всех владельцев конкретного эмитента; депозитарий — бумаги разных эмитентов у конкретного инвестора.
                    </p>
                  </div>

                  <div>
                    <h4 className="font-semibold">Инфраструктура организованных торгов</h4>
                    <ul className="list-disc pl-5 space-y-1.5">
                      <li><b>Организатор торговли (биржа).</b> Определяет правила торгов, листинг, допуск участников, устанавливает котировки и параметры рынка.</li>
                      <li><b>Клиринговая организация.</b> Сводит обязательства сторон (неттинг), расчёты «поставка против платежа», управление дефолтами.</li>
                      <li><b>Депозитарная система.</b> Сеть депозитариев во главе с центральным депозитарием; обеспечивает финальный переход прав собственности.</li>
                      <li><b>Репозитарий.</b> Учёт внебиржевых договоров РЕПО и производных; передача данных регулятору.</li>
                  </ul>
                </div>

                <div>
                    <h4 className="font-semibold">Как проходит типовая биржевая сделка (T+2)</h4>
                    <ol className="list-decimal pl-5 space-y-1">
                      <li>Инвестор даёт поручение <b>брокеру</b>.</li>
                      <li>Брокер размещает заявку на <b>бирже</b>; сделка матчитcя.</li>
                      <li><b>Клиринг</b> рассчитывает нетто-позиции и обязательства сторон.</li>
                      <li><b>Депозитарии</b> проводят переход прав и расчёты «поставка-против-платежа».</li>
                      <li><b>Регистратор</b> (для реестровых операций) или депозитарий фиксирует конечного владельца; эмитент получает данные для корпоративных действий.</li>
                    </ol>
                </div>
              </div>
          </details>

                

<details className="border rounded-xl p-3">
  <summary className="cursor-pointer font-medium">4. Фондовые индексы</summary>
  <div className="mt-2 text-sm text-gray-800 space-y-3">
    <p><b>Фондовый индекс</b> — агрегированный показатель изменения цен группы бумаг. Используется как «термометр» рынка, эталон для сравнения портфелей и база для деривативов.</p>

    <h4 className="font-semibold">Зачем рынку индексы</h4>
    <ul className="list-disc pl-5 space-y-1.5">
      <li>Барометр рынка и секторов.</li>
      <li>Бенчмарк для оценки результатов и основа индексных фондов.</li>
      <li>Инструмент хеджирования (фьючерсы и опционы на индекс).</li>
      <li>Макроиндикатор ожиданий бизнеса и домохозяйств.</li>
    </ul>

    <h4 className="font-semibold">Методы расчёта</h4>
    <ul className="list-disc pl-5 space-y-1.5">
      <li><b>Ценовой индекс</b> — вес бумаги пропорционален её цене (DJIA, Nikkei 225).</li>
      <li><b>По капитализации</b> — вес пропорционален рыночной капитализации с поправкой на free float (S&amp;P 500, FTSE 100, TOPIX, индексы Мосбиржи).</li>
      <li><b>С равными весами</b> и альтернативные схемы (ограничение максимального веса, факторные и др.).</li>
      <li>Есть «ценовые» версии (без дивидендов) и «доходные» (с реинвестированием дивидендов).</li>
    </ul>

    <h4 className="font-semibold">Крупнейшие индексы</h4>
    <p>DJIA, S&amp;P 500, FTSE 100, DAX, TOPIX, Nikkei 225. В РФ — <b>IMOEX</b> (рублёвый) и <b>РТС</b> (долларовый), а также секторные/тематические индексы.</p>

    <h4 className="font-semibold">Как читать индексы</h4>
    <ul className="list-disc pl-5 space-y-1.5">
      <li>Уточняйте методику, валюту индекса и период сопоставления.</li>
      <li>Смотрите концентрацию: долю крупнейших компонентов и ограничения весов.</li>
      <li>Сравнивайте портфель только с релевантным бенчмарком (рассчитывайте tracking error и active share).</li>
    </ul>

    <p className="text-xs text-gray-600">Ссылки: <a className="text-blue-600 hover:underline" href="https://www.moex.com/ru/index/IMOEX" target="_blank" rel="noreferrer">IMOEX</a>, <a className="text-blue-600 hover:underline" href="https://www.moex.com/ru/index/RTSI" target="_blank" rel="noreferrer">RTS</a></p>
  </div>
</details>


              </section>
            )}

            {/* ТЕСТ (20) */}
            {tab === 'quiz' && (
              <section className="bg-white rounded-2xl shadow border p-3 sm:p-4 space-y-4">
                <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                  <h2 className="font-semibold text-base sm:text-lg">Тест по теме (20 вопросов)</h2>
                  <div className="w-full sm:w-48"><Progress value={progress} /></div>
                </div>

                <div className="divide-y">
                  {QUIZ.map((item, idx) => (
                    <Q
                      key={idx}
                      item={item}
                      idx={idx}
                      value={answers[idx]}
                      onChange={(v) => setAnswers(a => { const b=[...a]; b[idx]=v; return b; })}
                    />
                  ))}
                </div>

                <div className="flex flex-col sm:flex-row sm:items-center gap-2">
                  <div className="flex gap-2">
                    <button onClick={()=>setShowResult(true)} className="px-3 py-1.5 rounded-xl border hover:bg-gray-100">Проверить</button>
                    <button onClick={exportQuiz} className="px-3 py-1.5 rounded-xl border hover:bg-gray-100">Экспорт результата (TXT)</button>
                  </div>
                  <div className="text-sm text-gray-600 sm:ml-auto">
                    Заполнено: {progress}%{" "}
                    {showResult && (
                      <span className="ml-3">
                        Результат: <b>{correctCount}/{QUIZ.length}</b> — {grade(correctCount/QUIZ.length)}
                      </span>
                    )}
                  </div>
                </div>
              </section>
            )}
          </main>

          <footer className="text-center text-[11px] sm:text-xs text-gray-500 pb-6">
            © {new Date().getFullYear()} Учебный симулятор. Собственная разработка автора.
          </footer>
        </div>
      );
    }

    /* ===================== Вспомогательные компоненты ===================== */
    function TabLink({id,tab,setTab,children}){
      const active = tab===id;
      return (
        <button onClick={()=>setTab(id)}
                className={`px-3 py-1.5 rounded-xl border text-sm ${active?'bg-gray-100 border-gray-300':'hover:bg-gray-100'}`}>
          {children}
        </button>
      );
    }
    function Stat({label,value,emphasize,isReturn}){
      let cls="text-gray-900"; let display=value;
      if(isReturn){
        const num=Number(value); display=(num>=0?"+":"")+(num*100).toFixed(2)+"%";
        cls = num>=0 ? "text-emerald-600" : "text-rose-600";
      }else if(emphasize){ cls="text-emerald-600"; }
      return (
        <div className="bg-gray-50 rounded-xl p-3 border">
          <div className="text-gray-600 text-xs">{label}</div>
          <div className={`text-sm font-semibold ${cls}`}>{display}</div>
        </div>
      );
    }
    function Row({a,onTrade}){
      const [qty,setQty]=React.useState(10);
      return (
        <tr className="border-t">
          <td className="py-2 px-2 font-mono">{a.secid}</td>
          <td className="py-2 px-2">{a.name}</td>
          <td className="py-2 px-2">{a.price.toLocaleString('ru-RU',{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
          <td className="py-2 px-2">
            <input type="number" min={1} value={qty} onChange={e=>setQty(Math.max(1,Number(e.target.value)||1))}
                   className="w-24 border rounded-xl px-2 py-1"/>
          </td>
          <td className="py-2 px-2">
            <div className="flex gap-2">
              <button className="px-3 py-1 rounded-xl border hover:bg-gray-100" onClick={()=>onTrade(a.secid,'buy',qty)}>Купить</button>
              <button className="px-3 py-1 rounded-xl border hover:bg-gray-100" onClick={()=>onTrade(a.secid,'sell',qty)}>Продать</button>
            </div>
          </td>
        </tr>
      );
    }
    function Sparkline({ title = "Стоимость портфеля", value }) {
  const canvasRef = React.useRef(null);
  const chartRef  = React.useRef(null);
  const [series, setSeries] = React.useState([]);

  // Копим историю (последние ~150 тиков)
  React.useEffect(() => {
    setSeries(prev => {
      const next = [...prev, Number(value || 0)];
      return next.length > 150 ? next.slice(next.length - 150) : next;
    });
  }, [value]);

  // Инициализация / обновление графика
  React.useEffect(() => {
    const el = canvasRef.current;
    if (!el) return;

    const ctx = el.getContext("2d");
    // Градиент под кривой
    const gradient = ctx.createLinearGradient(0, 0, 0, el.height);
    gradient.addColorStop(0, "rgba(59,130,246,0.35)");  // blue-500 @ 35%
    gradient.addColorStop(1, "rgba(59,130,246,0.00)");

    if (!chartRef.current) {
      chartRef.current = new Chart(ctx, {
        type: "line",
        data: {
          labels: series.map((_, i) => i + 1),
          datasets: [{
            data: series,
            borderColor: "rgb(59,130,246)",
            backgroundColor: gradient,
            fill: true,
            tension: 0.35,              // плавность
            pointRadius: 0,
            pointHitRadius: 12,
            borderWidth: 2,
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: { duration: 600 },
          interaction: { mode: "index", intersect: false },
          plugins: {
            legend: { display: false },
            tooltip: {
              displayColors: false,
              callbacks: {
                label: (ctx) =>
                  ` ${ctx.raw.toLocaleString("ru-RU", { style: "currency", currency: "RUB", maximumFractionDigits: 2 })}`
              }
            }
          },
          scales: {
            x: { display: false, grid: { display: false } },
            y: { display: false, grid: { display: false } }
          }
        }
      });
    } else {
      const ch = chartRef.current;
      ch.data.labels = series.map((_, i) => i + 1);
      ch.data.datasets[0].data = series;
      ch.update("none"); // без анимации при каждом тике
    }

    return () => { /* ничего не чистим — один canvas живёт в карточке */ };
  }, [series]);

  const first = series[0] ?? null;
  const last  = series[series.length - 1] ?? null;
  const pct   = (first && last) ? ((last - first) / first) : 0;

  return (
    <div className="border rounded-xl p-3">
      <div className="flex items-baseline justify-between mb-2">
        <div className="font-medium">{title}</div>
        <div className={`text-sm ${pct >= 0 ? "text-emerald-600" : "text-rose-600"}`}>
          изм.: { (pct >= 0 ? "+" : "") + (pct * 100).toFixed(2) }%
        </div>
      </div>
      <div className="h-40 relative">
        <canvas ref={canvasRef}></canvas>
      </div>
    </div>
  );
}
    function Donut({positions}){
      const data = positions.filter(p=>p.value>0);
      const total = data.reduce((s,x)=>s+x.value,0)||1;
      const size=220, stroke=36, r=(size-stroke)/2, cx=size/2, cy=size/2;
      const COLORS=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16","#f97316","#e11d48","#14b8a6"];
      let a0=0;
      const arcs = data.map((d,i)=>{
        const a1 = a0 + d.value/total*2*Math.PI;
        const color = COLORS[i % COLORS.length];
        const res = {a0, a1, label:d.label, color, val:d.value}; a0 = a1; return res;
      });
      const arc = (a0,a1) => {
        const large = a1-a0>Math.PI ? 1 : 0;
        const x0=cx+r*Math.cos(a0), y0=cy+r*Math.sin(a0);
        const x1=cx+r*Math.cos(a1), y1=cy+r*Math.sin(a1);
        return `M ${x0} ${y0} A ${r} ${r} 0 ${large} 1 ${x1} ${y1}`;
      };
      return (
        <div className="bg-gray-50 rounded-xl p-3 border">
          <div className="text-xs text-gray-600 mb-2">Структура портфеля</div>
          <svg width="100%" viewBox={`0 0 ${size} ${size}`} className="mx-auto">
            <circle cx={cx} cy={cy} r={r} fill="none" stroke="#e5e7eb" strokeWidth={stroke}/>
            {arcs.map((s,i)=>(
              <path key={i} d={arc(s.a0,s.a1)} strokeWidth={stroke} stroke={s.color} strokeLinecap="butt" fill="none">
                <title>{`${s.label}: ${(s.val/total*100).toFixed(1)}%`}</title>
              </path>
            ))}
          </svg>
          <div className="mt-2 grid grid-cols-2 gap-1 text-xs text-gray-700">
            {arcs.map((s,i)=>(
              <div key={i} className="flex items-center gap-2">
                <span style={{background:s.color}} className="inline-block w-3 h-3 rounded"></span>
                <span>{s.label}</span>
                <span className="ml-auto text-gray-500">{(s.val/total*100).toFixed(1)}%</span>
              </div>
            ))}
          </div>
        </div>
      );
    }
    function Progress({value}){ return (
      <div className="h-2 rounded-full bg-gray-200 overflow-hidden">
        <div className="h-full bg-emerald-500" style={{width:`${value}%`}}></div>
      </div>
    );}
    function Q({item,idx,value,onChange}){
      return (
        <div className="py-3">
          <div className="font-medium text-sm sm:text-base">{idx+1}. {item.q}</div>
          <div className="mt-1 grid sm:grid-cols-2 gap-2">
            {item.a.map((t,i)=>(
              <label key={i} className={`flex items-center gap-2 border rounded-xl p-2 cursor-pointer ${value===i?'bg-emerald-50 border-emerald-300':'hover:bg-gray-50'}`}>
                <input type="radio" name={`q${idx}`} checked={value===i} onChange={()=>onChange(i)}/>
                <span className="text-sm">{t}</span>
              </label>
            ))}
          </div>
        </div>
      );
    }
    function grade(p){
      if(p>=0.9) return "отлично";
      if(p>=0.75) return "хорошо";
      if(p>=0.6) return "удовлетворительно";
      return "нужно повторить материал";
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
